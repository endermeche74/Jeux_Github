<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Jeux - Training Pro</title>
    <style>
        :root {
            --bg: #0a0a0a;
            --panel: #161616;
            --gold: #d4af37;
            --text: #ffffff;
            --green: #27ae60;
            --red: #e74c3c;
            --accent: #3498db;
        }

        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0; padding: 0;
            display: flex; flex-direction: column; align-items: center;
        }

        .screen { width: 100%; max-width: 500px; padding: 20px; box-sizing: border-box; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .hidden { display: none !important; }

        /* --- UI COMPONENTS --- */
        .glass { background: var(--panel); border: 1px solid #333; border-radius: 15px; padding: 20px; margin-bottom: 20px; transition: 0.3s; }
        .glass:hover { border-color: var(--gold); }
        
        .btn { 
            padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s;
            text-transform: uppercase; font-size: 0.9rem;
        }
        .btn-gold { background: var(--gold); color: black; width: 100%; }
        .btn-action { background: #333; color: white; flex: 1; margin: 5px; border: 1px solid #555; }

        /* --- HOME SCREEN SPECIFIC --- */
        .main-title {
            text-align: center; margin-top: 50px; margin-bottom: 50px;
        }
        .main-title h1 {
            font-size: 3.5rem; letter-spacing: 8px; margin: 0; color: var(--gold);
        }
        .main-title p {
            font-size: 0.8rem; letter-spacing: 4px; color: #888; text-transform: uppercase;
        }

        /* --- GAME BOARD --- */
        .area-label { font-size: 0.8rem; color: #777; letter-spacing: 2px; margin-bottom: 10px; text-align: center; }
        .hand-container { display: flex; justify-content: center; gap: 10px; min-height: 120px; margin-bottom: 20px; }
        
        .mini-card {
            width: 70px; height: 100px; background: white; border-radius: 8px;
            color: black; display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 1.5rem; position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        .score-badge { background: var(--gold); color: black; padding: 2px 8px; border-radius: 4px; font-size: 0.9rem; font-weight: bold; }
        #feedback-msg { padding: 15px; border-radius: 8px; margin-top: 15px; font-weight: bold; text-align: center; display: none; }
        .correct { background: rgba(39, 174, 96, 0.2); color: #2ecc71; border: 1px solid #2ecc71; }
        .wrong { background: rgba(231, 76, 60, 0.2); color: #ff7675; border: 1px solid #e74c3c; }
    </style>
</head>
<body>

    <div id="home-screen" class="screen">
        <div class="main-title">
            <h1>JEUX</h1>
            <p>Training & Strat√©gie</p>
        </div>
        
        <div class="glass" onclick="showScreen('bj-setup')" style="cursor: pointer; border-left: 4px solid var(--gold);">
            <h2 style="margin:0; color:var(--gold);">üÉè Blackjack Pro</h2>
            <p style="color:#aaa; font-size:0.9rem; margin-top:5px;">Simulateur r√©el, strat√©gie de base et comptage Hi-Lo.</p>
        </div>

        <div class="glass" onclick="showScreen('papayoo-setup')" style="cursor: pointer; opacity: 0.7;">
            <h2 style="margin:0;">üé≠ Papayoo</h2>
            <p style="color:#aaa; font-size:0.9rem; margin-top:5px;">Gestionnaire de score pour vos parties entre amis.</p>
        </div>
    </div>

    <div id="bj-setup" class="screen hidden">
        <button class="btn" style="color:var(--gold); margin-bottom:10px;" onclick="showScreen('home-screen')">‚Üê RETOUR</button>
        <h2 style="color:var(--gold);">Configuration BJ</h2>
        <div class="glass">
            <label>Nombre de Decks :</label>
            <select id="decks-select" style="width:100%; padding:10px; margin:10px 0; background:#222; color:white; border:1px solid #444;">
                <option value="6">6 Decks (Standard)</option>
                <option value="1">1 Deck (Expert)</option>
            </select>
        </div>
        <button class="btn btn-gold" onclick="startGame()">Lancer la partie</button>
    </div>

    <div id="game-screen" class="screen hidden">
        <header style="display:flex; justify-content: space-between; margin-bottom:20px;">
            <button class="btn" style="color:var(--gold); padding:5px;" onclick="showScreen('home-screen')">üè† QUITTER</button>
            <div id="deck-info" style="font-size: 0.8rem; color: #888; align-self: center;">Decks: --</div>
        </header>

        <div class="area-label">DEALER <span id="dealer-score" class="score-badge">?</span></div>
        <div id="dealer-hand" class="hand-container"></div>

        <div class="area-label">PLAYER <span id="player-score" class="score-badge">0</span></div>
        <div id="player-hand" class="hand-container"></div>

        <div id="action-buttons" style="display:flex;">
            <button class="btn btn-action" onclick="playerHit()">Tirer</button>
            <button class="btn btn-action" onclick="playerStand()">Rester</button>
        </div>

        <div id="feedback-msg"></div>

        <div id="next-hand-area" class="hidden" style="margin-top:20px;">
            <button class="btn btn-gold" onclick="startNewHand()">Main Suivante</button>
            <button class="btn" style="color:var(--gold); width:100%; margin-top:10px;" onclick="checkCount()">V√©rifier le compte</button>
        </div>
    </div>

    <div id="count-modal" class="screen hidden" style="position:fixed; top:0; left:0; right:0; background:rgba(0,0,0,0.95); height:100vh; z-index:1000; padding:40px;">
        <h2 style="color:var(--gold); text-align:center;">ANALYSE</h2>
        <div class="glass" style="text-align:center;">
            <p>Running Count :</p>
            <div id="actual-rc" style="font-size:3rem; font-weight:bold; color:var(--gold);">0</div>
            <p>True Count : <span id="actual-tc">0</span></p>
        </div>
        <button class="btn btn-gold" onclick="document.getElementById('count-modal').classList.add('hidden')">RETOURNER AU JEU</button>
    </div>

    <script>
        let deck = [];
        let runningCount = 0;
        let playerHand = [];
        let dealerHand = [];
        let isGameOver = false;

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function startGame() {
            initDeck();
            showScreen('game-screen');
            startNewHand();
        }

        function initDeck() {
            const numDecks = document.getElementById('decks-select').value;
            const suits = ['‚ô†','‚ô•','‚ô¶','‚ô£'];
            const vals = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
            deck = [];
            for(let i=0; i<numDecks; i++) {
                for(let s of suits) { for(let v of vals) { deck.push({v, s}); } }
            }
            deck.sort(() => Math.random() - 0.5);
            runningCount = 0;
        }

        function startNewHand() {
            if(deck.length < 10) initDeck();
            isGameOver = false;
            playerHand = []; dealerHand = [];
            document.getElementById('feedback-msg').style.display = 'none';
            document.getElementById('next-hand-area').classList.add('hidden');
            document.getElementById('action-buttons').classList.remove('hidden');
            deal('player'); deal('dealer'); deal('player');
            updateUI();
        }

        function deal(target) {
            const card = deck.pop();
            if(['2','3','4','5','6'].includes(card.v)) runningCount++;
            if(['10','J','Q','K','A'].includes(card.v)) runningCount--;
            if(target === 'player') playerHand.push(card); else dealerHand.push(card);
            updateUI();
        }

        function getScore(hand) {
            let s = 0; let a = 0;
            for(let c of hand) {
                if(c.v === 'A') a++;
                else if(['J','Q','K','10'].includes(c.v)) s += 10;
                else s += parseInt(c.v);
            }
            for(let i=0; i<a; i++) s += (s + 11 <= 21) ? 11 : 1;
            return s;
        }

        function updateUI() {
            renderCards('player-hand', playerHand);
            renderCards('dealer-hand', dealerHand, true);
            document.getElementById('player-score').innerText = getScore(playerHand);
            document.getElementById('deck-info').innerText = `Deck: ${(deck.length/52).toFixed(1)}`;
        }

        function renderCards(id, hand, hide = false) {
            const el = document.getElementById(id); el.innerHTML = '';
            hand.forEach((c, i) => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'mini-card';
                if(hide && i === 0 && !isGameOver) {
                    cardDiv.innerText = '?'; cardDiv.style.background = '#333';
                } else {
                    cardDiv.innerText = c.v;
                    cardDiv.style.color = (c.s === '‚ô•' || c.s === '‚ô¶') ? 'var(--red)' : 'black';
                }
                el.appendChild(cardDiv);
            });
        }

        function playerHit() {
            deal('player');
            if(getScore(playerHand) > 21) endGame("BUST !");
        }

        function playerStand() {
            isGameOver = true;
            while(getScore(dealerHand) < 17) deal('dealer');
            const ps = getScore(playerHand); const ds = getScore(dealerHand);
            if(ds > 21 || ps > ds) endGame("GAGN√â !");
            else if (ps < ds) endGame("PERDU !");
            else endGame("√âGALIT√â");
        }

        function endGame(msg) {
            isGameOver = true; updateUI();
            document.getElementById('dealer-score').innerText = getScore(dealerHand);
            document.getElementById('action-buttons').classList.add('hidden');
            document.getElementById('next-hand-area').classList.remove('hidden');
            const f = document.getElementById('feedback-msg');
            f.style.display = 'block'; f.innerText = msg;
        }

        function checkCount() {
            const dr = Math.max(0.5, deck.length / 52);
            document.getElementById('actual-rc').innerText = runningCount;
            document.getElementById('actual-tc').innerText = Math.floor(runningCount / dr);
            document.getElementById('count-modal').classList.remove('hidden');
        }
    </script>
</body>
</html>
